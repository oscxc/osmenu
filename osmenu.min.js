"use strict";(function(a){if(typeof module==="object"&&typeof module.exports==="object"){module.exports=a}else{window.osmenu=a}})(function(o){function e(i){return Object.prototype.toString.apply(i).slice(8,-1)}function v(i,j){for(var B in j){i[B]=j[B]}}function d(j,E){var D=e(j);if(D==="Array"||D==="NodeList"||D==="Arguments"){for(var C=0;C<j.length;C++){E(C,j[C])}}else{if(D==="Object"){for(var B in j){E(B,j[B])}}else{if(D==="Number"){for(var C=0;C<j;C++){E(C,j)}}else{throw new TypeError("该对象不支持遍历")}}}}function m(j,i){var B;switch(j){case"text":B=document.createTextNode(i);break;case"comment":B=document.createComment(i);break;case"fragment":B=document.createDocumentFragment();break;default:B=document.createElement(j);if(i){d(i,function(D,C){B.setAttribute(D,C)})}break}return B}function g(i){return m("div",{"class":i})}function l(i,j){if(e(j)==="String"){return window.getComputedStyle(i).getPropertyValue(j)}else{d(j,function(C,B){i.style[C]=B})}}function a(j,C,B){var D=B?B:"beforeEnd";var i=e(C)=="Array"?C:[C];d(i,function(F,E){if(e(E)=="String"){j.insertAdjacentHTML(D,E)}else{j.insertAdjacentElement(D,E)}});return j}function k(j,i,E,D){var C=i;var G=Math.ceil(D*60/1000);var B=(E-i)/G;function F(){G--;C+=B;if(G>0){if(G===1){C=E}j.style.height=C+"px";requestAnimationFrame(F)}}requestAnimationFrame(F)}var y={createItem:g,createTitle:g,createBox:g,createSvgIcon:function(D){function B(E){return document.createElementNS("http://www.w3.org/2000/svg",E)}function i(F,G,E){F.setAttribute(G,E)}var C=B("path");i(C,"fill",D.color?D.color:"black");i(C,"d",D.data);var j=B("svg");i(j,"viewBox",D.viewBox?D.viewBox:"0 0 24 24");if(D.className){i(j,"class",D.className)}j.appendChild(C);return j},setSvgData:function(i,j){i.childNodes[0].setAttribute("d",j)},createText:function(j){var i=m("span");i.innerHTML=j;return i}};var f={data:{},open:true,activeIndex:[0,0],changeTime:240,mode:false,loadRunCallback:true,callback:function(){}};v(f,o);var t=f.data.open&&f.data.close&&f.data.open!=""&&f.data.close!="";var b=m("div",{'class':"osmenu"});var w=[];var A=f.data.data;for(var u=0;u<A.length;u++){var h=y.createBox("menu-box");h.open=true;h.tit=y.createTitle("box-title");if(A[u].title.svg&&A[u].title.svg!=""){h.tit.icon=y.createSvgIcon({data:A[u].title.svg});a(h.tit,h.tit.icon)}h.tit.text=y.createText(A[u].title.name);a(h.tit,h.tit.text);if(t){h.tit.open_close=y.createSvgIcon({data:f.data.open});a(h.tit,h.tit.open_close)}a(b,a(h,h.tit));var p=A[u].items;h.items=[];for(var q=0;q<p.length;q++){h.items[q]=y.createItem("box-item");if(p[q].svg&&p[q].svg!=""){h.items[q].icon=y.createSvgIcon({data:p[q].svg});a(h.items[q],h.items[q].icon)}if(p[q].url&&p[q].url!=""){h.items[q].url=p[q].url}h.items[q].text=y.createText(p[q].name);a(h,a(h.items[q],h.items[q].text))}w.push(h)}a(document.body,b,"afterBegin");var n=w[0].items[0].getBoundingClientRect().height;var x=w[0].tit.getBoundingClientRect().height;if(f.open!==true){for(var u=0;u<w.length;u++){w[u].open=false}if(f.open!==false){w[f.open].open=true}}for(var u=0;u<w.length;u++){if(!w[u].open){if(t){y.setSvgData(w[u].tit.open_close,f.data.close)}w[u].style.height=x+"px"}}var s;if(f.activeIndex!=false){if(e(f.activeIndex)=="String"){for(var u=0;u<A.length;u++){var r=false;for(var q=0;q<A[u].items.length;q++){if(f.activeIndex==A[u].items[q].name){s=[u,q];r=true;break}}if(r){break}}}else{s=f.activeIndex}}else{s=false}function c(){w[s[0]].tit.classList.remove("title-active");w[s[0]].items[s[1]].classList.remove("item-active")}function z(){if(s!=false){w[s[0]].tit.classList.add("title-active");w[s[0]].items[s[1]].classList.add("item-active")}}z();if(f.loadRunCallback){if(s===false){throw new Error("使用错误：activeIndex 为 false，首次加载无法执行callback")}f.callback(w[s[0]].items[s[1]].text.innerText,s)}for(var u=0;u<A.length;u++){(function(C){var D=w[C];D.tit.addEventListener("click",function(){var j=x,i=x+n*D.items.length;if(D.open){if(t){y.setSvgData(this.open_close,f.data.close)}new k(D,i,j,f.changeTime)}else{if(t){y.setSvgData(this.open_close,f.data.open)}new k(D,j,i,f.changeTime)}D.open=!D.open});for(var B=0;B<D.items.length;B++){(function(i){D.items[i].addEventListener("click",function(){if(f.mode){c();s=[C,i];z();f.callback(this.text.innerText,s)}else{location.href=this.url}})})(B)}})(u)}});
